<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analizador Pedagógico TeleEducación - TulaSalud</title>
    <!-- Incluye Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Estilos generales */
        body {
            font-family: 'Inter', sans-serif; /* Fuente moderna y legible */
            background-color: #1A1A1A; /* Negro profundo para el fondo */
            color: #E0E0E0; /* Blanco suave para el texto */
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Alinea al inicio verticalmente */
            min-height: 100vh;
            box-sizing: border-box; /* Incluye padding en el tamaño total */
            /* Cambia el cursor del ratón por la imagen de dedo.png */
            cursor: url('https://raw.githubusercontent.com/google/gemini-micro-web/main/assets/img/dedo.png'), auto;
            /* Se usa raw.githubusercontent.com para acceder directamente a la imagen.
               'auto' es el cursor de respaldo si la imagen no se carga o no es válida.
               Idealmente, la imagen del cursor debe ser pequeña (por ejemplo, 32x32px o 48x48px)
               y en formato .cur o .png con transparencia para un mejor rendimiento. */
        }

        .container {
            background-color: #282828; /* Un gris oscuro elegante */
            border-radius: 12px; /* Esquinas más redondeadas */
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); /* Sombra más pronunciada */
            padding: 30px;
            width: 100%;
            max-width: 900px; /* Ancho máximo para escritorio */
            box-sizing: border-box;
            text-align: center;
            margin-bottom: 40px; /* Espacio para el contenido debajo */
        }

        /* Estilos para el logo en el encabezado */
        .header-logo {
            margin-bottom: 20px; /* Espacio debajo del logo */
        }

        .header-logo img {
            max-width: 120px; /* Tamaño máximo para el logo en escritorio */
            height: auto; /* Mantiene la proporción */
            border-radius: 50%; /* Hace la imagen circular si es cuadrada */
            border: 3px solid #00BFFF; /* Borde de color de acento */
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.5); /* Sombra luminosa */
            display: block; /* Para centrar con margin auto */
            margin: 0 auto; /* Centra la imagen */
        }

        h1 {
            color: #00BFFF; /* Azul claro para el título, un toque de color */
            margin-bottom: 25px;
            font-size: 2.2em;
            font-weight: 700;
        }

        p {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 20px;
            color: #B0B0B0; /* Gris más claro para párrafos */
        }

        /* Área de subida de archivos */
        .upload-area {
            border: 3px dashed #444444; /* Borde punteado más oscuro */
            border-radius: 10px;
            padding: 40px 20px;
            margin-bottom: 30px;
            cursor: pointer; /* Cursor de puntero para indicar interactividad */
            transition: background-color 0.3s ease, border-color 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }

        .upload-area:hover {
            background-color: #3A3A3A; /* Fondo ligeramente más claro al pasar el ratón */
            border-color: #00BFFF; /* Resalta el borde al pasar el ratón */
        }

        .upload-area i {
            font-size: 3.5em; /* Icono más grande */
            color: #00BFFF;
            margin-bottom: 15px;
        }

        .upload-area p {
            margin: 0;
            font-size: 1.2em;
            color: #E0E0E0;
        }

        #fileInput {
            display: none; /* Oculta el input de archivo por defecto */
        }

        /* Grupo de botones principales (Analizar, LLM features) */
        .button-group {
            display: flex;
            justify-content: center;
            flex-wrap: wrap; /* Permite que los botones se envuelvan */
            gap: 15px; /* Espacio entre los botones */
            margin-top: 20px;
            margin-bottom: 20px; /* Para separar de los resultados */
        }

        /* Estilos base para todos los botones */
        .upload-button, .llm-feature-button, .action-button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer; /* Cursor de puntero para acciones clicables */
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
            color: white; /* Color de texto por defecto para la mayoría de botones */
        }

        /* Estilo para el botón de 'Analizar Archivo' */
        .upload-button {
            background-color: #007BFF; /* Azul principal */
        }
        .upload-button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        /* Estilo para los botones de funciones LLM */
        .llm-feature-button {
            background-color: #8A2BE2; /* Púrpura para funciones de IA */
            margin-top: 0; /* Asegura que el margen se gestione por el gap del button-group */
        }
        .llm-feature-button:hover {
            background-color: #6A1AAB;
        }

        /* Estilos para los botones de acción al final */
        .action-button {
            /* Colores definidos más abajo para cada tipo de botón */
            margin: 10px; /* Margen para asegurar separación en flex-wrap */
        }
        .action-button:hover {
            transform: translateY(-2px);
        }

        /* Colores específicos para los botones de acción */
        .action-button.reset-button {
            background-color: #0060B0; /* Azul oscuro para 'Cargar otro archivo' */
            color: #E0E0E0;
        }
        .action-button.reset-button:hover {
            background-color: #004F90;
        }

        .action-button.close-button {
            background-color: #A03030; /* Rojo apagado para 'Cerrar' */
            color: #E0E0E0;
        }
        .action-button.close-button:hover {
            background-color: #8C2A2A;
        }

        /* Indicador de carga general */
        .loading-indicator, .llm-loading-indicator {
            display: none; /* Oculto por defecto */
            margin-top: 30px;
            font-size: 1.2em;
            color: #00BFFF;
        }

        .loading-indicator .spinner, .llm-loading-indicator .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #00BFFF;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Área de resultados */
        .results-area {
            background-color: #333333; /* Un gris más oscuro para la caja de resultados */
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            text-align: left;
            border: 1px solid #444444; /* Borde sutil */
        }

        /* Justifica el texto dentro de la sección de resultados (párrafos y listas) */
        .results-area p, .results-area ul, .results-area ol {
            text-align: justify; /* Justifica el texto */
        }
        .results-area ul li, .results-area ol li {
            text-align: justify; /* Asegura la justificación también en elementos de lista */
        }

        .results-area h2 {
            color: #00BFFF;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.6em;
            border-bottom: 1px solid #444444;
            padding-bottom: 10px;
        }

        .results-area p {
            margin-bottom: 10px;
            color: #D0D0D0;
        }

        .results-area ul {
            list-style-type: disc;
            margin-left: 20px;
            padding-left: 0;
            color: #D0D0D0;
        }

        .results-area ul li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        /* NUEVOS ESTILOS PARA LAS TARJETAS DE EVALUACIÓN Y OBSERVACIONES */
        .evaluation-card, .observations-card {
            background-color: #3A3A3A; /* Un gris más claro para contraste */
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px; /* Espacio entre las tarjetas */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); /* Sombra suave para efecto de elevación */
            border: 1px solid #444444; /* Borde sutil */
        }

        /* Justifica el texto dentro de las tarjetas */
        .evaluation-card p, .evaluation-card ul, .evaluation-card ol {
            text-align: justify;
        }
        .evaluation-card ul li, .evaluation-card ol li {
            text-align: justify;
        }
        .observations-card p, .observations-card ul, .observations-card ol {
            text-align: justify;
        }
        .observations-card ul li, .observations-card ol li {
            text-align: justify;
        }

        .evaluation-card h3, .observations-card h3 {
            color: #00BFFF; /* Título de la evaluación y observaciones (ahora el mismo color) */
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.4em;
            border-bottom: 1px solid #555555;
            padding-bottom: 8px;
            text-align: center; /* Centra los títulos de las tarjetas */
        }

        .llm-output-section {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #555555;
        }

        .llm-output-section h3 {
            color: #8A2BE2; /* Púrpura para los títulos de la IA */
            margin-bottom: 10px;
        }

        /* Contenedor para los botones de acción post-análisis */
        .action-buttons-after-analysis {
            display: flex;
            justify-content: center;
            flex-wrap: wrap; /* Permite que los botones se envuelvan en pantallas pequeñas */
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #444444;
            display: none; /* Oculto por defecto, se muestra con JS */
        }


        /* Footer */
        .footer {
            margin-top: 30px;
            font-size: 0.85em;
            color: #888888; /* Gris más claro para el texto del footer */
        }

        /* Media Queries para responsividad */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            .header-logo img {
                max-width: 100px; /* Ajuste para tablets */
            }
            h1 {
                font-size: 1.8em;
            }
            .upload-area {
                padding: 30px 15px;
                min-height: 150px;
            }
            .upload-area i {
                font-size: 2.8em;
            }
            .upload-area p {
                font-size: 1em;
            }
            .button-group .upload-button,
            .button-group .llm-feature-button {
                width: calc(50% - 15px); /* Dos botones por fila */
                margin: 0; /* Reset margin from general rules */
            }
            .button-group {
                gap: 15px; /* Ensure gap is applied */
            }
            .action-buttons-after-analysis {
                flex-direction: column; /* Apila los botones en columnas */
                gap: 10px; /* Espacio entre botones apilados */
            }
            .action-buttons-after-analysis .action-button {
                width: calc(100% - 20px); /* Ocupa casi todo el ancho en columnas */
                margin: 0; /* Reset margin from general rules, use gap from parent */
            }
            .results-area {
                padding: 20px;
            }
            .results-area h2 {
                font-size: 1.4em;
            }
            .evaluation-card, .observations-card {
                padding: 15px;
            }
            .evaluation-card h3, .observations-card h3 {
                font-size: 1.2em;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 15px;
            }
            .header-logo img {
                max-width: 80px; /* Ajuste para móviles */
            }
            h1 {
                font-size: 1.5em;
            }
            .upload-area {
                padding: 25px 10px;
                min-height: 120px;
            }
            .upload-area i {
                font-size: 2.2em;
            }
            .upload-area p {
                font-size: 0.9em;
            }
            .button-group {
                flex-direction: column; /* Apila todos los botones en columnas */
                gap: 10px;
            }
            .button-group .upload-button,
            .button-group .llm-feature-button,
            .action-buttons-after-analysis .action-button {
                width: calc(100% - 20px); /* Botón de ancho completo en móvil */
                padding: 12px;
                margin: 0; /* Sin margen lateral */
            }
            .results-area {
                padding: 15px;
            }
            .results-area h2 {
                font-size: 1.2em;
            }
            .evaluation-card, .observations-card {
                padding: 10px;
            }
            .evaluation-card h3, .observations-card h3 {
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Contenedor para el logo en el encabezado -->
        <div class="header-logo">
            <img src="https://pbs.twimg.com/profile_images/535655953480175616/D5VRHaDd_400x400.jpeg"
                 alt="Logo de TulaSalud"
                 onerror="this.onerror=null; this.src='https://placehold.co/400x400/8A2BE2/FFFFFF?text=Logo';" />
        </div>

        <h1><i class="fas fa-brain"></i> Analizador Pedagógico TeleEducación - TulaSalud</h1>
        <p>Sube tus archivos PDF, imágenes o presentaciones para un análisis impulsado por IA.</p>

        <div class="upload-area" id="uploadArea">
            <i class="fas fa-cloud-upload-alt"></i>
            <p>Arrastra y suelta tu archivo aquí, o haz click para seleccionar</p>
            <input type="file" id="fileInput" accept=".pdf, image/jpeg, image/png, .ppt, .pptx">
        </div>

        <div class="button-group">
            <button class="upload-button" id="analyzeButton" disabled>Analizar Archivo</button>
        </div>

        <div class="loading-indicator" id="loadingIndicator">
            <div class="spinner"></div>
            <p>Analizando archivo con el Modelo de IA...</p>
        </div>

        <div class="results-area" id="resultsArea" style="display: none;">
            <h2><i class="fas fa-chart-bar"></i> Resultados del Análisis</h2>
            <div id="analysisContent">
                <!-- Las tarjetas se insertarán aquí dinámicamente -->
            </div>
            <!-- Nuevo indicador de carga para las funciones LLM -->
            <div class="llm-loading-indicator" id="llmLoadingIndicator">
                <div class="spinner"></div>
                <p>Generando contenido con IA...</p>
            </div>
            <div id="llmOutput" class="llm-output-section">
                <!-- Aquí se mostrarán los resultados del LLM -->
            </div>
        </div>

        <!-- Nuevos botones de acción que se muestran después del análisis -->
        <div class="action-buttons-after-analysis" id="actionButtons">
            <button class="action-button reset-button" id="resetButton"><i class="fas fa-redo"></i> Cargar otro archivo</button>
            <button class="action-button close-button" id="closePageButton"><i class="fas fa-times-circle"></i> Cerrar Página</button>
        </div>

        <div class="footer">
            <p>© 2025 Lic. Luis Ygnacio Ponce Sierra | Todos los derechos reservados</p>
        </div>
    </div>

    <script>
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const analyzeButton = document.getElementById('analyzeButton');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const resultsArea = document.getElementById('resultsArea');
        const analysisContent = document.getElementById('analysisContent');
        const llmLoadingIndicator = document.getElementById('llmLoadingIndicator');
        const llmOutput = document.getElementById('llmOutput');
        const actionButtons = document.getElementById('actionButtons');
        const resetButton = document.getElementById('resetButton');
        const closePageButton = document.getElementById('closePageButton');
        const container = document.querySelector('.container'); // Referencia al contenedor para mensajes

        let selectedFile = null;

        // Previene el comportamiento por defecto de arrastrar y soltar
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false); // También para el body
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // Resalta el área al arrastrar el archivo
        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.style.borderColor = '#00BFFF', false);
        });

        // Vuelve al borde normal al salir del área
        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.style.borderColor = '#444444', false);
        });

        // Maneja la caída del archivo
        uploadArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            // Asegura que solo se procese un archivo
            if (files.length > 0) {
                handleFileSelection(files[0]);
            }
        }

        // Abre el explorador de archivos al hacer click en el área de subida
        uploadArea.addEventListener('click', () => fileInput.click());

        // Maneja la selección de archivos desde el input
        fileInput.addEventListener('change', (e) => {
            // Asegura que solo se procese un archivo
            if (e.target.files.length > 0) {
                handleFileSelection(e.target.files[0]);
            }
        });

        /**
         * Maneja el archivo seleccionado, actualiza el UI y habilita el botón de análisis.
         * Esta función se llama cuando se selecciona un nuevo archivo.
         * @param {File} file - El archivo seleccionado.
         */
        function handleFileSelection(file) {
            selectedFile = file;
            // Muestra el nombre del archivo en el área de subida
            uploadArea.querySelector('p').textContent = `Archivo seleccionado: ${selectedFile.name}`;
            analyzeButton.disabled = false; // Habilita el botón de analizar

            // Resetea el estado de la UI para un nuevo archivo, pero manteniendo el archivo seleccionado
            resultsArea.style.display = 'none';
            llmOutput.innerHTML = '';
            loadingIndicator.style.display = 'none';
            llmLoadingIndicator.style.display = 'none';
            actionButtons.style.display = 'none';
            // Asegura que el área de subida y el botón de análisis estén visibles
            uploadArea.style.display = 'flex';
            analyzeButton.style.display = 'block';
        }

        // Maneja el clic en el botón de analizar
        analyzeButton.addEventListener('click', () => {
            if (selectedFile) {
                startAnalysis(selectedFile);
            } else {
                // Usamos un modal o un mensaje dentro de la página en lugar de alert()
                displayMessage("Por favor, selecciona un archivo para analizar.", "error");
            }
        });

        /**
         * Simula el proceso de análisis inicial de un archivo por una IA.
         * @param {File} file - El archivo a "analizar".
         */
        function startAnalysis(file) {
            // Oculta el área de subida y muestra el indicador de carga
            uploadArea.style.display = 'none';
            analyzeButton.style.display = 'none';
            loadingIndicator.style.display = 'block';
            resultsArea.style.display = 'none'; // Asegura que los resultados estén ocultos
            llmOutput.innerHTML = ''; // Limpia el contenido LLM anterior
            actionButtons.style.display = 'none'; // Oculta los botones de acción mientras se analiza

            // Simula el proceso de análisis inicial
            setTimeout(() => {
                // SIMULACIÓN: Determina si el contenido es relevante para el sector salud.
                // En una aplicación real, esto implicaría un análisis de contenido profundo con un LLM.
                // Para esta demostración, hay un 80% de probabilidad de que *no* sea relevante
                // para que el usuario pueda ver el mensaje de "no detectado".
                const isHealthRelatedContent = Math.random() < 0.2; 

                let evaluationContent = '';
                let observationsContent = '';
                let llmButtons = '';

                if (file.type.includes('pdf') || file.type.includes('image') || file.type.includes('presentation') || file.type.includes('powerpoint')) {
                    if (!isHealthRelatedContent) {
                        evaluationContent = `
                            <h3>Análisis de Contenido</h3>
                            <p><strong>Tipo de Archivo:</strong> ${file.type.includes('pdf') ? 'Documento PDF' : file.type.includes('image') ? 'Archivo de Imagen' : 'Presentación (PPT/PPTX)'}</p>
                            <p style="color:#DC3545; font-weight:bold; font-size:1.1em;">⚠️ Contenido No Detectado como Relacionado con el Sector Salud o Educación Comunitaria</p>
                            <p>Nuestro análisis no detectó contenido directamente relacionado con el sector salud o educación comunitaria según el perfil de Tele Educación de TulaSalud. Por lo tanto, no se puede realizar una evaluación pedagógica detallada bajo estos criterios.</p>
                            <p>Por favor, sube un archivo que trate sobre temas de salud, educación comunitaria o desarrollo social relevantes para la misión de TulaSalud en Guatemala.</p>
                        `;
                        observationsContent = `
                            <h3>Observaciones de Mejora</h3>
                            <p style="color:#DC3545;">No se pueden ofrecer observaciones de mejora específicas alineadas con las políticas de TulaSalud, ya que el contenido no se asocia con el sector de salud o educación comunitaria.</p>
                        `;
                        llmButtons = ''; // No mostrar botones LLM si no es relevante para la salud
                    } else {
                        // Lógica detallada original para contenido relacionado con la salud
                        if (file.type.includes('pdf')) {
                            evaluationContent = `
                                <h3>Evaluación Pedagógica del Contenido</h3>
                                <p><strong>Tipo de Archivo:</strong> Documento PDF</p>
                                <ul>
                                    <li><strong>Estructura y organización:</strong> El documento parece bien organizado por secciones, lo que facilita el seguimiento. Sin embargo, un "modelo guía" visual al inicio (como un diagrama de flujo) podría dar una visión general para adultos que prefieren un panorama antes del detalle.</li>
                                    <li><strong>Lenguaje y alfabetización funcional:</strong> El vocabulario es mayormente accesible para personas con escolaridad básica. Términos como "vigilancia epidemiológica" podrían beneficiarse de ejemplos concretos o un glosario breve y contextualizado. Reforzar con situaciones cotidianas (ej., cómo se detecta una enfermedad en la comunidad) sería muy útil.</li>
                                    <li><strong>Pertinencia cultural y lingüística:</strong> Los ejemplos actuales son generales. Sería valioso incluir referencias a la realidad rural e indígena de Guatemala (ej., uso de plantas medicinales tradicionales junto a medicina moderna, o cómo se gestionan los nacimientos en comunidades). Considerar la inclusión de frases o un glosario simple en idiomas mayas (q’eqchi’, k’iche’, mam) para mejorar la inclusividad.</li>
                                    <li><strong>Conexión con Tele Educación de TulaSalud:</strong> No se identifican llamadas a la acción directas para estrategias de educación a distancia (ej., códigos QR para videos explicativos, enlaces a foros de discusión móvil). Aunque el contenido es relevante, no se menciona explícitamente su utilidad en la vigilancia materno-infantil o nutricional bajo el modelo de TulaSalud. Podría sugerirse la replicación mediante "plantillas" o "guías para el facilitador" al final del documento.</li>
                                    <li><strong>Accesibilidad visual y técnica:</strong> El contraste de colores para el texto es bueno. El tamaño de letra es adecuado en general, pero asegurarse de que los gráficos o tablas incrustadas mantengan un tamaño de fuente legible (≥ 14 pts) en impresión y dispositivos móviles. Los elementos gráficos deben ser claros incluso en blanco y negro, sin depender de tonos sutiles.</li>
                                    <li><strong>Enfoque andragógico:</strong> Se observa un buen intento de estructurar el contenido para adultos. Se podría incentivar más la participación activa añadiendo preguntas de reflexión al final de cada sección o pequeños ejercicios guiados que conecten el contenido con sus experiencias previas.</li>
                                    <li><strong>Equidad de género y estructuras familiares:</strong> La representación de familias parece convencional. Podría ampliarse para incluir visuales o menciones textuales de familias monoparentales, reconstituidas, o con abuelos/cuidadores como figuras principales. Analizar la simbología de género para que sea inclusiva con identidades no binarias en futuros materiales, si es aplicable al contexto.</li>
                                    <li><strong>Actualización y atribución de fuentes:</strong> No se encontró una fecha de última revisión o los responsables claros del contenido. Es fundamental incluir estos datos y acreditar a las instancias oficiales (MSPAS) y a TulaSalud, asegurando la vigencia y autoridad del material.</li>
                                </ul>
                            `;
                            observationsContent = `
                                <h3>Observaciones de Mejora (Alineada con políticas educativas guatemaltecas para jóvenes y adultos, así como el perfil de Tele Educación de TulaSalud)</h3>
                                <ul>
                                    <li><strong>1. Contexto intercultural y multilingüe:</strong> Implementar glosarios bilingües (español–lenguas mayas como q’eqchi’, k’iche’, mam, etc.) al final del documento. Incorporar pequeños recuadros con frases o ejemplos de texto en idioma local que refuercen conceptos clave, especialmente para temas culturales sensibles.</li>
                                    <li><strong>2. Ejemplos prácticos contextualizados:</strong> Desarrollar un caso guía de una familia rural guatemalteca que aborde condiciones prevalentes (desnutrición infantil, embarazo adolescente en zonas de difícil acceso). Incluir ejercicios prácticos paso a paso en el texto, con espacios designados para que el usuario anote sus propias observaciones o resultados.</li>
                                    <li><strong>3. Adaptación a metodologías a distancia:</strong> Integrar códigos QR o enlaces directos a videos cortos (ej., demostraciones de procedimientos de salud) y audios (ej., testimonios en idiomas locales) que complementen el texto. Crear versiones imprimibles con alto contraste y formato amigable para dispositivos móviles de baja gama.</li>
                                    <li><strong>4. Enriquecimiento de contenido de salud:</strong> Ampliar la sección de "función" o introducción con ejemplos específicos de riesgos biológicos, psicológicos y sociales directamente ligados a la salud materno-infantil y nutricional en Guatemala, con datos relevantes del MSPAS.</li>
                                    <li><strong>5. Refuerzo visual de simbología:</strong> Si el documento contiene símbolos, sugerir la adición de iconos adicionales o leyendas ampliadas y visualmente claras para cada símbolo (edad, sexo, defunción, embarazo, etc.), asegurando su comprensión universal.</li>
                                    <li><strong>6. Representación de estructuras familiares diversas:</strong> Incluir descripciones textuales o pequeños viñetas que presenten la diversidad de familias guatemaltecas (monoparentales, reconstituidas, multigeneracionales, con abuelos o tíos como cuidadores).</li>
                                    <li><strong>7. Aspectos de género y ciclo de vida:</strong> Detallar cómo abordar la prevención del embarazo adolescente y los riesgos asociados en las comunidades rurales. Referenciar los programas gubernamentales o de TulaSalud relacionados con la salud sexual y reproductiva de jóvenes.</li>
                                    <li><strong>8. Accesibilidad y usabilidad:</strong> Asegurar que el tamaño de fuente general del documento sea ≥ 14 pts, con interlineado adecuado. Verificar que el contraste de texto y fondo sea siempre alto, y que los trazos de cualquier gráfico sean lo suficientemente gruesos para legibilidad en condiciones diversas.</li>
                                    <li><strong>9. Preguntas frecuentes (FAQs):</strong> Proponer un pequeño apartado al final del documento con preguntas comunes sobre el tema, como: "¿Cómo anoto si un familiar vive en el extranjero?", "¿Qué hago si no conozco la edad exacta de un familiar?", etc.</li>
                                    <li><strong>10. Vinculación con servicios y contacto:</strong> Incluir contactos claros de TulaSalud (WhatsApp, correo electrónico, redes sociales o números de teléfono locales) para que el personal comunitario pueda solicitar tutorías o retroalimentación sobre el material.</li>
                                    <li><strong>11. Módulos de Autoevaluación/Reflexión (Texto):</strong> Integrar pequeños ejercicios de autoevaluación o preguntas para la reflexión personal dentro del documento, que refuercen el aprendizaje y su vinculación con la práctica diaria.</li>
                                    <li><strong>12. Promoción de la Colaboración Interinstitucional (Documento):</strong> Si el contenido se presta, sugerir cómo la información del documento puede fomentar la coordinación con la Dirección de Recursos Humanos del MSPAS y la Escuela Nacional de Enfermería de Cobán, reflejando el modelo colaborativo de TulaSalud.</li>
                                </ul>
                            `;
                            llmButtons = '<button class="llm-feature-button" onclick="generateComprehensionQuestions()">Generar Preguntas de Comprensión ✨</button>';
                        } else if (file.type.includes('image')) {
                            evaluationContent = `
                                <h3>Evaluación Pedagógica del Contenido</h3>
                                <p><strong>Tipo de Archivo:</strong> Archivo de Imagen (${file.type.split('/')[1].toUpperCase()})</p>
                                <ul>
                                    <li><strong>Estructura y organización:</strong> La imagen es un elemento visual estático. Su "estructura" se basa en la composición y el flujo de la información gráfica. Para un aprendizaje incremental, podría ser parte de una secuencia de imágenes o de un material más amplio. Sugerir un pie de foto explicativo es clave para la organización.</li>
                                    <li><strong>Lenguaje y alfabetización funcional:</strong> Si la imagen contiene texto, se evaluó su legibilidad y simplicidad. Los símbolos visuales son generalmente claros, pero algunos podrían requerir una leyenda adicional para ser universalmente comprendidos por audiencias con escolaridad básica en Guatemala.</li>
                                    <li><strong>Pertinencia cultural y lingüística:</strong> La imagen (si aplica) debería incluir elementos visuales que resuenen con la realidad rural e indígena de Guatemala (ej., vestimenta, escenarios). Los símbolos o representaciones deben evitar sesgos culturales y ser comprensibles sin necesidad de textos complejos.</li>
                                    <li><strong>Conexión con Tele Educación de TulaSalud:</strong> La imagen por sí misma no integra estrategias directas de educación a distancia, pero su formato la hace adaptable a plataformas digitales. Se evaluaría si puede ser utilizada para ilustrar puntos clave en la vigilancia epidemiológica materno-infantil o nutricional de TulaSalud.</li>
                                    <li><strong>Accesibilidad visual y técnica:</strong> El contraste de la imagen y la legibilidad de cualquier texto incrustado son cruciales. Se evaluó que los detalles sean claros incluso en pantallas pequeñas de dispositivos móviles y que se mantengan inteligibles al imprimirse en blanco y negro o escanearse.</li>
                                    <li><strong>Enfoque andragógico:</strong> Como imagen estática, su interactividad es limitada. El enfoque andragógico se lograría al complementarla con actividades o preguntas que inviten a la observación activa y a la conexión con experiencias previas del adulto.</li>
                                    <li><strong>Equidad de género y estructuras familiares:</strong> Si la imagen representa personas o familias, se observó la diversidad en la representación de género y estructuras familiares. Se sugiere que futuras imágenes muestren una amplia gama de composiciones familiares y roles de género inclusivos.</li>
                                    <li><strong>Actualización y atribución de fuentes:</strong> Una imagen por sí misma no suele tener fecha de revisión, pero es fundamental que el material pedagógico que la contenga especifique la fuente y fecha de creación/revisión.</li>
                                </ul>
                            `;
                            observationsContent = `
                                <h3>Observaciones de Mejora (Alineada con políticas educativas guatemaltecas para jóvenes y adultos, así como el perfil de Tele Educación de TulaSalud)</h3>
                                <ul>
                                    <li><strong>1. Impacto Visual y Relevancia Cultural:</strong> Crear o seleccionar imágenes que reflejen explícitamente la diversidad multiétnica de Guatemala, incluyendo vestimenta, entornos y situaciones relevantes para las comunidades rurales y el personal de salud de los departamentos meta de TulaSalud.</li>
                                    <li><strong>2. Claridad de Mensaje Visual:</strong> La imagen debe comunicar un mensaje de salud de forma inequívoca y accesible, considerando las limitaciones de conectividad en zonas rurales para la mejora de cobertura.</li>
                                    <li><strong>3. Apoyo Visual a Contenidos de Salud Clave:</strong> Diseñar o seleccionar imágenes que complementen y refuercen visualmente temas centrales para TulaSalud, como procedimientos de salud materna, signos de alerta en niños, o guías nutricionales adaptadas a alimentos locales.</li>
                                    <li><strong>4. Fomento de Competencias por Observación:</strong> Acompañar la imagen con preguntas guía o ejercicios visuales que dirijan la atención del adulto a puntos clave, fomentando la observación activa y la aplicación práctica de lo que la imagen muestra.</li>
                                    <li><strong>5. Accesibilidad Visual y Descripciones:</strong> Asegurar alto contraste, trazos gruesos y tamaños de texto legibles para cualquier elemento incrustado. Proporcionar descripciones "alt text" detalladas para la imagen, facilitando la accesibilidad digital y comprensión.</li>
                                    <li><strong>6. Simbolismo de Progreso y Acceso:</strong> Utilizar elementos visuales que simbolicen la mejora en la cobertura de servicios de salud y el impacto positivo de la tele-educación en las comunidades, mostrando el avance y la conectividad.</li>
                                    <li><strong>7. Optimización para Distribución Remota (Imágenes):</strong> Asegurar que la imagen esté optimizada en tamaño y formato (ej., webp, JPG comprimido) para una descarga y visualización eficientes en dispositivos móviles y conexiones de baja velocidad.</li>
                                    <li><strong>8. Coherencia con Mensajes de Prevención Visuales:</strong> Si la imagen aborda un tema de salud, debe reforzar visualmente mensajes clave de prevención y promoción de la salud materna e infantil de manera clara y directa.</li>
                                    <li><strong>9. Potencial de Interacción y Discusión Visual:</strong> Si la imagen se usa en una plataforma digital, considerar la posibilidad de añadir "hotspots" interactivos que, al hacer clic, ofrezcan información adicional o preguntas relacionadas con el contenido visual.</li>
                                    <li><strong>10. Reflejo de la Atención Primaria (Imágenes):</strong> Las imágenes deben evocar o ilustrar escenarios auténticos de atención primaria de salud en contextos rurales, mostrando la interacción del personal de salud con la comunidad.</li>
                                    <li><strong>11. Motivación a Través de la Imagen:</strong> Utilizar imágenes inspiradoras que reconozcan el valor del personal de salud en áreas remotas y refuercen su compromiso con la misión de TulaSalud.</li>
                                    <li><strong>12. Evidencia de Impacto Comunitario (Imágenes):</strong> Si es posible, incluir imágenes que muestren el impacto real de las acciones de TulaSalud en las comunidades, fortaleciendo la conexión del personal con su trabajo.</li>
                                </ul>
                            `;
                            llmButtons = '<button class="llm-feature-button" onclick="generateDetailedImageDescription()">Generar Descripción Detallada ✨</button>';
                        } else if (file.type.includes('presentation') || file.type.includes('powerpoint')) {
                            evaluationContent = `
                                <h3>Evaluación Pedagógica del Contenido</h3>
                                <p><strong>Tipo de Archivo:</strong> Presentación (PPT/PPTX)</p>
                                <ul>
                                    <li><strong>Estructura y organización:</strong> La presentación sigue una secuencia lógica, con una introducción y desarrollo claros. Se podría beneficiar de una diapositiva "roadmap" al inicio para que la audiencia visualice el recorrido y los objetivos de aprendizaje para adultos.</li>
                                    <li><strong>Lenguaje y alfabetización funcional:</strong> El lenguaje en las diapositivas es adecuado para audiencias con escolaridad básica, pero algunos términos técnicos pueden requerir una explicación oral adicional o una diapositiva de glosario. La simplificación de frases complejas en viñetas cortas es recomendable.</li>
                                    <li><strong>Pertinencia cultural y lingüística:</strong> Las imágenes y ejemplos en la presentación podrían ser más culturalmente relevantes para las comunidades rurales e indígenas de Guatemala. Incluir ejemplos de interacciones comunitarias o visuales de prácticas locales mejoraría la conexión.</li>
                                    <li><strong>Conexión con Tele Educación de TulaSalud:</strong> La presentación se adapta a una modalidad a distancia, pero podría integrar más elementos interactivos específicos (ej., encuestas rápidas, espacios para preguntas) o enlaces a recursos adicionales (videos, sitios web de TulaSalud). Es importante que se mencione explícitamente la utilidad del material en la vigilancia epidemiológica materno-infantil o nutricional que promueve TulaSalud.</li>
                                    <li><strong>Accesibilidad visual y técnica:</strong> El contraste de colores y el tamaño de letra en las diapositivas son en general buenos. Se debe asegurar que las gráficas y diagramas sean fácilmente legibles en proyectores o pantallas compartidas, incluso con baja resolución. Evitar el exceso de texto por diapositiva.</li>
                                    <li><strong>Enfoque andragógico:</strong> La presentación tiene potencial para incentivar la participación activa. Se pueden añadir preguntas de reflexión o pequeños casos de estudio en las diapositivas para estimular el pensamiento crítico y la aplicación práctica por parte de los jóvenes y adultos.</li>
                                    <li><strong>Equidad de género y estructuras familiares:</strong> Se observa la representación de género, pero podría ampliarse para mostrar familias diversas (monoparentales, reconstituidas, multigeneracionales) en las imágenes y ejemplos de texto, reflejando la realidad guatemalteca.</li>
                                    <li><strong>Actualización y atribución de fuentes:</strong> Es importante que la presentación incluya la fecha de última revisión y los responsables (institución, departamento del MSPAS, equipo de TulaSalud) para asegurar la credibilidad y vigencia del contenido.</li>
                                </ul>
                            `;
                            observationsContent = `
                                <h3>Observaciones de Mejora (Alineada con políticas educativas guatemaltecas para jóvenes y adultos, así como el perfil de Tele Educación de TulaSalud)</h3>
                                <ul>
                                    <li><strong>1. Diseño para Tele-Presentación:</strong> Optimizar cada diapositiva para la comprensión a distancia, usando menos texto, más gráficos y un diseño limpio. Limitarse a 3-5 puntos clave por diapositiva.</li>
                                    <li><strong>2. Relevancia y Aplicabilidad Local (Presentación):</strong> Incluir diapositivas dedicadas a casos de estudio y escenarios prácticos de salud relevantes para las comunidades rurales de los departamentos meta de TulaSalud, con datos y ejemplos locales.</li>
                                    <li><strong>3. Fortalecimiento de Competencias Específicas (PPT):</strong> Asegurar que las diapositivas con contenido clave se centren en las competencias que TulaSalud busca fortalecer en salud materna, infantil, nutrición y vigilancia epidemiológica, usando ejemplos claros.</li>
                                    <li><strong>4. Brevedad y Enfoque al Grano (Diapositivas):</strong> Reformular textos largos en viñetas concisas y fáciles de recordar. Cada diapositiva debe tener un mensaje principal claro, evitando la sobrecarga de información.</li>
                                    <li><strong>5. Enfoque Intercultural y de Género (PPT):</strong> Utilizar imágenes y ejemplos en las diapositivas que sean culturalmente sensibles y representen la diversidad de género y etnias de Guatemala. Incluir un glosario visual o de texto con términos clave en idiomas mayas si es pertinente.</li>
                                    <li><strong>6. Participación Activa para Adultos (Diapositivas):</strong> Integrar preguntas de discusión abiertas en diapositivas clave, o pequeños ejercicios interactivos (ej., "¿Qué harías en esta situación?") que promuevan la participación activa.</li>
                                    <li><strong>7. Visualización de Datos Clave (Gráficos PPT):</strong> Si la presentación contiene datos, usar infografías o gráficos sencillos y de alto impacto visual que sean fáciles de interpretar y relevantes para la toma de decisiones en salud.</li>
                                    <li><strong>8. Accesibilidad Técnica en Zonas Rurales (Presentación):</strong> Verificar que la presentación sea compatible con diversas versiones de software y dispositivos, y que el tamaño del archivo sea manejable para descargas en conexiones limitadas.</li>
                                    <li><strong>9. Guía para Facilitadores (en PPT):</strong> Incluir notas para el orador en cada diapositiva, proporcionando contexto adicional, preguntas para el debate y adaptaciones sugeridas para diferentes audiencias o situaciones de formación.</li>
                                    <li><strong>10. Mensajes Motivacionales y de Retención (PPT):</strong> Incorporar diapositivas que reconozcan el esfuerzo y el impacto del personal de salud en áreas remotas, y que refuercen su conexión con la misión de TulaSalud.</li>
                                    <li><strong>11. Integración Estratégica de Multimedia (PPT):</strong> Recomendar la inclusión de videos cortos (idealmente auto-alojados o de baja resolución) o enlaces a recursos de audio que complementen el contenido de la diapositiva sin sobrecargarla.</li>
                                    <li><strong>12. Promoción de la E-Salud Comunitaria (Contenido PPT):</strong> Si aplica, resaltar el papel de la presentación en el impulso y apoyo al uso de sistemas comunitarios de E-Salud por el personal de salud.</li>
                                </ul>
                            `;
                            llmButtons = '<button class="llm-feature-button" onclick="suggestSpeakerPoints()">Sugerir Puntos Clave para el Orador ✨</button>';
                        }
                    }
                } else { // Manejar tipos de archivo verdaderamente desconocidos
                    evaluationContent = `
                        <h3>Análisis de Contenido</h3>
                        <p><strong>Tipo de Archivo:</strong> Tipo de archivo desconocido</p>
                        <p style="color:#DC3545; font-weight:bold;">⚠️ Formato de Archivo No Compatible</p>
                        <p>Lo siento, el Analizador Pedagógico TeleEducación no puede procesar este tipo de archivo en este momento. Por favor, sube un PDF, una imagen (JPG, PNG) o una presentación (PPT/PPTX).</p>
                    `;
                    observationsContent = `
                        <h3>Observaciones de Mejora</h3>
                        <p style="color:#DC3545;">No se pueden ofrecer observaciones de mejora para formatos de archivo no compatibles.</p>
                    `;
                    llmButtons = ''; // No mostrar botones LLM para tipos desconocidos
                }

                // Oculta el indicador de carga principal y muestra los resultados
                loadingIndicator.style.display = 'none';
                
                // Estos elementos solo se muestran DESPUÉS de que el análisis inicial haya terminado
                uploadArea.style.display = 'flex'; 
                analyzeButton.style.display = 'block'; 
                analyzeButton.disabled = true; // Deshabilita hasta nueva selección
                uploadArea.querySelector('p').textContent = 'Arrastra y suelta tu archivo aquí, o haz click para seleccionar'; 
                fileInput.value = ''; 
                selectedFile = null; // Reinicia el archivo seleccionado para evitar re-análisis sin nueva selección

                // Insertar las tarjetas en el analysisContent
                analysisContent.innerHTML = `
                    <div class="evaluation-card">
                        ${evaluationContent}
                    </div>
                    <div class="observations-card">
                        ${observationsContent}
                    </div>
                    <div class="llm-feature-buttons button-group">
                        ${llmButtons}
                    </div>
                `;
                resultsArea.style.display = 'block'; 
                actionButtons.style.display = 'flex'; 
            }, 3000); // Simula un retraso de 3 segundos para el análisis inicial
        }

        /**
         * Simula la generación de preguntas de comprensión con un LLM (para PDF).
         */
        function generateComprehensionQuestions() {
            llmLoadingIndicator.style.display = 'block';
            llmOutput.innerHTML = ''; // Limpiar salida anterior

            setTimeout(() => {
                const questions = [
                    "¿Cómo se relaciona el objetivo principal de este documento con la misión de TulaSalud de reducir la mortalidad materna e infantil en los departamentos meta de Alta Verapaz, Huehuetenango, Sololá y Quiché?",
                    "Explica con tus propias palabras dos conceptos clave presentados y cómo el personal de salud en áreas rurales, multiétnicas y multilingües de Guatemala podría aplicarlos para mejorar la atención primaria.",
                    "Identifica un ejemplo o caso práctico. ¿Cómo podría este ejemplo ser adaptado o enriquecido para reflejar la realidad específica de una comunidad rural guatemalteca, considerando las dificultades de acceso?",
                    "Según el documento, ¿qué elementos visuales serían más efectivos para un Auxiliar de Enfermería Comunitaria capacitado por TulaSalud, considerando su contexto de tele-educación y la importancia de la nutrición en estas poblaciones?",
                    "Si tuvieras que mejorar una sección de este documento para que se alinee más con las directrices de Tele Capacitación de TulaSalud sobre salud reproductiva y el fortalecimiento de competencias del personal, ¿qué cambio harías?",
                    "¿Qué preguntas adicionales te surgen sobre cómo este contenido podría ser implementado para fortalecer las competencias del personal de salud en el uso de las TIC para la vigilancia epidemiológica en zonas postergadas?",
                    "¿De qué manera la estructura del documento promueve (o podría promover mejor) la formación a distancia con un enfoque intercultural y de género, tan crucial para TulaSalud?",
                    "Si este documento fuera parte de un diplomado de TulaSalud, ¿qué tipo de actividad práctica sugerirías para asegurar que los participantes apliquen el conocimiento directamente en los servicios de salud en sus regiones de origen?",
                    "¿Qué tipo de recurso complementario (ej. un micro-video de un caso real de atención materna en Huehuetenango o una infografía sobre nutrición adaptada a la dieta local) crees que sería más útil para este documento, alineado con el uso de TIC de TulaSalud?",
                    "Identifica una fortaleza clave en el diseño de la información que facilite el aprendizaje y contribuya directamente a la mejora de la cobertura en salud y las capacidades del MSPAS para la población materno-infantil y niños menores de cinco años."
                ];
                let output = '<h3>Preguntas de Comprensión Sugeridas por IA ✨</h3><ul>';
                questions.forEach(q => { output += `<li>${q}</li>`; });
                output += '</ul><p><em>Estas preguntas buscan evaluar la comprensión profunda y crítica del contenido, con un enfoque en la relevancia para jóvenes y adultos y la alineación con las políticas educativas guatemaltecas y el perfil de Tele Educación de TulaSalud.</em></p>';
                llmOutput.innerHTML = output;
                llmLoadingIndicator.style.display = 'none';
            }, 2500); // Simula un retraso de 2.5 segundos para la generación de preguntas
        }

        /**
         * Simula la generación de una descripción detallada de imagen con un LLM.
         */
        function generateDetailedImageDescription() {
            llmLoadingIndicator.style.display = 'block';
            llmOutput.innerHTML = ''; // Limpiar salida anterior

            setTimeout(() => {
                const description = `
                    <h3>Descripción Detallada de Imagen Sugerida por IA ✨</h3>
                    <p>La IA interpreta esta imagen como una representación altamente conceptual de un entorno de aprendizaje dinámico, probablemente en el ámbito de la teleeducación. Se observa una paleta de colores que evoca profesionalismo y claridad, con elementos que sugieren interconexión y flujo de información.</p>
                    <p><strong>Análisis Pedagógico Visual (Alineada con políticas educativas guatemaltecas para jóvenes y adultos, así como el perfil de Tele Educación de TulaSalud):</strong></p>
                    <ul>
                        <li><strong>Propósito Didáctico en Tele-Educación:</strong> La imagen sirve como metáfora visual para el proceso de aprendizaje digital, enfatizando la interacción de ideas y la conectividad, fundamental para la modalidad a distancia de TulaSalud y la mejora de cobertura en salud.</li>
                        <li><strong>Relevancia para la Audiencia de TulaSalud:</strong> Su diseño moderno y limpio puede ser atractivo para el personal de salud (auxiliares de enfermería, técnicos en salud rural, médicos), sugiriendo un enfoque innovador en la capacitación a distancia.</li>
                        <li><strong>Contextualización Regional (Guatemala):</strong> Aunque abstracta, esta imagen podría complementarse con elementos visuales sutiles que la conecten a la realidad de las comunidades multiétnicas, multilingües y rurales de los departamentos meta de TulaSalud (Alta Verapaz, Huehuetenango, Sololá o Quiché) para mayor identificación.</li>
                        <li><strong>Fomento del Uso de TIC para Competencias:</strong> La imagen visualiza un flujo de información digital, lo cual refuerza el mensaje de TulaSalud sobre el uso de las TIC para mejorar las competencias del recurso humano en salud y apoyar el uso de sistemas de E-Salud.</li>
                        <li><strong>Impacto en la Salud Materna e Infantil:</strong> Se puede interpretar como la interconexión de datos y conocimientos que, a través de la tele-capacitación, contribuye a la reducción de la mortalidad materna e infantil, y al aumento de la capacidad del MSPAS.</li>
                        <li><strong>Accesibilidad Visual:</strong> La simplicidad de las formas y los contrastes de color facilitan la percepción visual, importante para el personal que podría acceder a los materiales en diversas condiciones y con posibles limitaciones de infraestructura.</li>
                        <li><strong>Potencial de Discusión:</strong> La imagen puede ser un excelente punto de partida para discutir cómo las tecnologías superan las barreras geográficas y de acceso, facilitando el conocimiento y la interconexión en el aprendizaje a distancia para el personal de salud en zonas remotas.</li>
                    </ul>
                    <p><strong>Sugerencias para el uso óptimo en Tele Capacitación de TulaSalud:</strong></p>
                    <ul>
                        <li>Integrar con un texto que la referencie explícitamente, explicando su metáfora visual en el contexto de la mejora de servicios de salud a través de la tele-educación, con énfasis en la atención primaria y la población vulnerable en Guatemala.</li>
                        <li>Considerar animación sutil si se usa en un entorno web para reforzar la idea de dinamismo y flujo de información en la vigilancia epidemiológica o la capacitación continua.</li>
                        <li>Utilizarla como punto de partida para una discusión sobre cómo la "arquitectura" del conocimiento en línea empodera al personal de salud en las regiones de TulaSalud para servir mejor a la población.</li>
                        <li>Si se busca ilustrar temas específicos de salud (materna, infantil, nutrición), complementar con imágenes de casos de éxito o escenarios reales que resuenen con la experiencia del personal de salud en las comunidades guatemaltecas.</li>
                    </ul>
                `;
                llmOutput.innerHTML = description;
                llmLoadingIndicator.style.display = 'none';
            }, 2500); // Simula un retraso
        }

        /**
         * Simula la sugerencia de puntos clave para el orador con un LLM (para PPT).
         */
        function suggestSpeakerPoints() {
            llmLoadingIndicator.style.display = 'block';
            llmOutput.innerHTML = ''; // Limpiar salida anterior

            setTimeout(() => {
                const points = [
                    "<strong>Diapositiva 1 (Título):</strong> 'Bienvenidos a la Tele Capacitación de TulaSalud: Mejorando la Salud Materna e Infantil en Guatemala'. Conectar con la misión central y el impacto directo en las comunidades de los departamentos meta (Alta Verapaz, Huehuetenango, Sololá y Quiché).",
                    "<strong>Diapositiva 2 (Agenda y Beneficios):</strong> 'Lo que aprenderán hoy para fortalecer sus competencias y mejorar la cobertura en salud'. Destacar cómo la capacitación contribuirá directamente a los objetivos de TulaSalud y del MSPAS para madres y niños.",
                    "<strong>Diapositva 3 (El Desafío Guatemalteco):</strong> 'Superando barreras: la salud en poblaciones multiétnicas, multilingües, rurales y postergadas'. Contextualizar el problema que TulaSalud aborda con la tele-educación, haciendo énfasis en las dificultades de acceso.",
                    "<strong>Diapositiva 4 (Nuestro Enfoque - Tele-Educación):</strong> 'Cómo TulaSalud utiliza las TIC para el desarrollo de competencias en salud a distancia y el impulso de la E-Salud'. Explicar la metodología y sus ventajas para el personal en ejercicio (Auxiliares de Enfermería, Técnicos, Médicos).",
                    "<strong>Diapositiva 5 (Temas Clave de TulaSalud):</strong> 'Profundizando en salud materna, infantil, nutrición y vigilancia epidemiológica'. Desglosar los contenidos esenciales, vinculándolos con la práctica diaria del personal de salud en la atención primaria.",
                    "<strong>Diapositiva 6 (Casos de Éxito y Lecciones Aprendidas):</strong> 'El impacto en la práctica: Ejemplos de nuestros departamentos meta'. Presentar casos reales de éxito de TulaSalud o sus colaboradores en la reducción de mortalidad o mejora de servicios en Alta Verapaz, Huehuetenango, Sololá o Quiché.",
                    "<strong>Diapositiva 7 (Uso de Tecnología para Vigilancia Epidemiológica):</strong> 'Fortaleciendo la E-Salud comunitaria y la recopilación de datos para la toma de decisiones'. Explicar cómo el equipamiento y la capacitación en TIC apoyan la vigilancia y el acceso a servicios básicos.",
                    "<strong>Diapositiva 8 (Enfoque Intercultural y de Género):</strong> 'Atención con pertinencia cultural y equidad para nuestra población diversa'. Abordar cómo la formación respeta y se adapta a la diversidad de las comunidades guatemaltecas, un pilar fundamental de TulaSalud.",
                    "<strong>Diapositiva 9 (Preguntas y Aplicación Práctica):</strong> 'Aplicando lo aprendido: Preguntas y escenarios clínicos basados en la realidad local'. Fomentar la discusión y la resolución de problemas basados en la experiencia del personal y los desafíos reales.",
                    "<strong>Diapositiva 10 (Sostenibilidad y Futuro de la Capacitación):</strong> 'El camino hacia la mejora continua: el compromiso de TulaSalud y el rol del personal'. Inspirar al personal sobre el impacto a largo plazo de su formación y su papel en el fortalecimiento del MSPAS.",
                    "<strong>Diapositiva 11 (Agradecimientos y Compromiso):</strong> '¡Gracias por su compromiso con la salud de Guatemala y con la misión de TulaSalud!'. Reconocer el valor del personal de salud y su rol crucial en la atención a la población vulnerable.",
                    "<strong>Diapositiva 12 (Recursos y Contacto):</strong> 'Recursos adicionales para su formación y apoyo continuo en el uso de las TIC y los servicios de salud'. Proporcionar enlaces a materiales de apoyo y formas de contacto para asistencia técnica continua, como parte de la estrategia de TulaSalud."
                ];
                let output = '<h3>Puntos Clave para el Orador Sugeridos por IA ✨</h3><ul>';
                points.forEach(q => { output += `<li>${q}</li>`; });
                output += '</ul><p><em>Estas preguntas buscan evaluar la comprensión profunda y crítica del contenido, con un enfoque en la relevancia para jóvenes y adultos en el contexto guatemalteco, alineado con las políticas educativas guatemaltecas y el perfil de Tele Educación de TulaSalud.</em></p>';
                llmOutput.innerHTML = output;
                llmLoadingIndicator.style.display = 'none';
            }, 2500); // Simula un retraso
        }

        /**
         * Reinicia el estado de la UI a su condición inicial para permitir la carga de un nuevo archivo.
         */
        function resetUIState() {
            selectedFile = null; // Resetea el archivo seleccionado
            fileInput.value = ''; // Limpia el valor del input de archivo
            uploadArea.querySelector('p').textContent = 'Arrastra y suelta tu archivo aquí, o haz click para seleccionar'; // Restablece el texto del área de subida
            analyzeButton.disabled = true; // Deshabilita el botón de analizar
            resultsArea.style.display = 'none'; // Oculta la sección de resultados
            llmOutput.innerHTML = ''; // Limpia el contenido generado por LLM
            loadingIndicator.style.display = 'none'; // Oculta el indicador de carga principal
            llmLoadingIndicator.style.display = 'none'; // Oculta el indicador de carga del LLM
            actionButtons.style.display = 'none'; // Oculta los botones de acción post-análisis
        }

        // Event listeners para los nuevos botones de acción
        resetButton.addEventListener('click', resetUIState); // Botón para cargar otro archivo (reinicia la UI)

        closePageButton.addEventListener('click', () => {
            // Reinicia la UI para simular un "cierre" en este entorno de sandbox
            resetUIState();
            displayMessage("La interfaz se ha restablecido. Puedes cargar un nuevo archivo.", "info");
        });

        // Función para mostrar mensajes personalizados (en lugar de alert)
        function displayMessage(message, type = "info") {
            // Eliminar cualquier mensaje existente para evitar duplicados
            const existingMessageBox = container.querySelector('.message-box');
            if (existingMessageBox) {
                existingMessageBox.remove();
            }

            // Crear un div para el mensaje
            const messageBox = document.createElement('div');
            messageBox.textContent = message;
            messageBox.className = 'message-box'; // Añadir una clase para facilitar la selección

            messageBox.style.padding = '15px';
            messageBox.style.borderRadius = '8px';
            messageBox.style.marginTop = '20px';
            messageBox.style.color = '#fff';
            messageBox.style.fontWeight = 'bold';
            messageBox.style.textAlign = 'center';

            if (type === "error") {
                messageBox.style.backgroundColor = '#DC3545'; // Rojo para errores
            } else {
                messageBox.style.backgroundColor = '#007BFF'; // Azul para información
            }

            // Añadir al contenedor principal
            container.insertBefore(messageBox, uploadArea.nextSibling); // Insertar después del área de carga

            // Eliminar el mensaje después de unos segundos
            setTimeout(() => {
                messageBox.remove();
            }, 5000);
        }
    </script>
</body>
</html>
